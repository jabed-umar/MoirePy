<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://jabed-umar.github.io/MoirePy/getting_started/prepare_layers/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Prepare Layers - MoirePy – Python Library for Moiré Lattice Simulation</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../assets/_mkdocstrings.css" rel="stylesheet" />
        <link href="../../assets/style.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Prepare Layers";
        var mkdocs_page_input_path = "getting_started/prepare_layers.md";
        var mkdocs_page_url = "/MoirePy/getting_started/prepare_layers/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> MoirePy – Python Library for Moiré Lattice Simulation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Getting Started</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../gs_intro/">Getting Started</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../installation/">Installation</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Prepare Layers</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#defining-a-layer">Defining a layer</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#defining-some-example-lattices">Defining Some Example Lattices</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#square-lattice">Square Lattice</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#kagome-lattice">Kagome Lattice</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#inbuilt-layers">Inbuilt Layers</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../moire_lattice_and_hamiltonian/">Moiré Lattice and Hamiltonian</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../examples/">EXAMPLE NOTEBOOKS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Theoretical Background</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../theory/theory_intro/">Theoretical Background</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../theory/tight_binding_ham/">Tight Binding Moiré Hamiltonian</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../theory/search_algorithm_kdtree/">Searching Algorithm & KDTree</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../theory/angle_calculation_process/">Angle Calculation Process</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../theory/avc/">Angle Value Calculator</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">API Reference</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/layers/">Layers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/moire/">Moire</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/utils/">Utils</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">MoirePy – Python Library for Moiré Lattice Simulation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Getting Started</li>
      <li class="breadcrumb-item active">Prepare Layers</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/jabed-umar/MoirePy/edit/master/docs/getting_started/prepare_layers.md">Edit on jabed-umar/MoirePy</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="prepare-layers">Prepare Layers</h1>
<!-- Welcome to **MoirePy**! This guide will help you begin using MoirePy for research and simulations involving moiré materials. -->

<p>After successfully <a href="../installation/">installing MoirePy</a>, this tutorial will walk you through the process of constructing moiré lattices from individual lattice layers.</p>
<p>As you may know, moiré patterns emerge when two lattice layers are stacked with a slight rotational misalignment between them. In this guide, we'll start by defining individual layers using MoirePy, and then demonstrate how to combine them to generate a moiré lattice.</p>
<ul>
<li><a href="#prepare-layers">Prepare Layers</a><ul>
<li><a href="#defining-a-layer">Defining a layer</a><ul>
<li><a href="#defining-some-example-lattices">Defining Some Example Lattices</a><ul>
<li><a href="#square-lattice">Square Lattice</a></li>
<li><a href="#kagome-lattice">Kagome Lattice</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#inbuilt-layers">Inbuilt Layers</a></li>
</ul>
</li>
</ul>
<h2 id="defining-a-layer">Defining a layer</h2>
<p>We will start by importing the parent class <code>Layer</code> from MoirePy, which helps us define single layers.</p>
<pre class="highlight"><code class="language-python">&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; import matplotlib.pyplot as plt
&gt;&gt;&gt; from moirepy import Layer</code></pre>
<p>The <code>Layer</code> class handles tasks such as generating lattice points, identifying their neighbours, managing boundary conditions, efficiently searching for specific points in the lattice, and more. For <code>Layer</code> to work properly, we need to define the following properties of a lattice:</p>
<ul>
<li><strong>Lattice vectors</strong>: These define the periodicity of the lattice. In MoirePy, they are named <code>lv1</code> and <code>lv2</code>. For simplicity, <code>lv1</code> must lie along the <span class="arithmatex">\(x\)</span>-direction, and <code>lv2</code> must lie above the <span class="arithmatex">\(x\)</span>-axis. This is a reasonable constraint, as any lattice can be expressed in this form.</li>
<li><strong>Lattice points</strong>: These are the points within the unit cell of the lattice. Each point is defined by its coordinates <strong>relative to the unit cell</strong>, along with a unique identifier (called a point type). The point type is useful for lattices with multiple points per unit cell (such as hexagonal or kagome lattices).</li>
<li><strong>Neighbours</strong>: This is a dictionary defining the neighbours of each lattice point. Each key is a point type, and its value is a list of vectors that represent the <strong>relative positions of the neighbouring points</strong>.</li>
</ul>
<p>Omitting even one of these properties will result in an error.</p>
<h3 id="defining-some-example-lattices">Defining Some Example Lattices</h3>
<p>First, we will start with a simple square lattice, which has only one lattice point in the unit cell and four orthogonal neighbours. Then we will look at a more complex example — the kagome lattice — which has three lattice points in the unit cell and four neighbours each.</p>
<h4 id="square-lattice">Square Lattice</h4>
<p>Now let us define a square lattice using this <code>Layer</code> class.</p>
<pre class="highlight"><code class="language-python">class SquareLayer(Layer):  # Inherit the Layer class
    def __init__(self, pbc=False, study_proximity: int=1) -&gt; None:
        self.lv1 = np.array([1, 0])
        self.lv2 = np.array([0, 1])
        self.lattice_points = (
            # location of the point inside the unit cell
            [0, 0, "A"],  # coo_x, coo_y, point_type (unique string)
        )
        self.neighbours = {
            "A": [
                [-1, 0],  # Left
                [1, 0],   # Right
                [0, 1],   # Up
                [0, -1],  # Down
            ],
        }
        # do not forget to initialise the parent class at the end
        super().__init__(pbc=pbc, study_proximity=study_proximity)</code></pre>
<div class="admonition note">
<p class="admonition-title">Things to Note</p>
<ul>
<li>Make sure to define all required properties for the lattice.</li>
<li>Remember to include <code>super().__init__(pbc=pbc, study_proximity=study_proximity)</code> at the end of your <code>__init__</code> method to properly initialize the parent class.</li>
<li>The values in <code>self.neighbours</code> are defined <em>relative to the lattice points</em>. So if the lattice point moves, the neighbour positions will automatically update — no manual changes needed.</li>
</ul>
</div>
<p>Now we can create an instance of this <code>SquareLayer</code> class:</p>
<pre class="highlight"><code class="language-python">&gt;&gt;&gt; square_layer = SquareLayer(pbc=True, study_proximity=1)
&gt;&gt;&gt; square_layer
Layer(
    lv1 = [1 0],
    lv2 = [0 1],
    lattice_points = ([0, 0, 'A'],),
    pbc = True,
)</code></pre>
<p>Next, let us try plotting this lattice. First, we need to generate the points and then plot them.</p>
<pre class="highlight"><code class="language-python">&gt;&gt;&gt; square_layer.generate_points(
&gt;&gt;&gt;     np.array([7, 0]),
&gt;&gt;&gt;     np.array([0, 5]),
&gt;&gt;&gt;     1, 1, test=True
&gt;&gt;&gt; )</code></pre>
<p>Making moiré lattices requires precise cutting of the layers. This can only be done using the Moiré lattice classes. Since we’re cutting them arbitrarily here, we set <code>test=True</code> and <code>mln1 = mln2 = 1</code> to prevent the system from freaking out.</p>
<p>Now, we can either use the attributes <code>square_layer.points</code> and <code>square_layer.point_types</code> to manually plot the lattice, or — for quick testing — use the built-in <code>Layer.plot_lattice()</code> method. <strong>However, we encourage you to write your own customised plotting function to better suit your preferences.</strong></p>
<pre class="highlight"><code class="language-python">&gt;&gt;&gt; square_layer.plot_lattice()</code></pre>
<p><img alt="Square Lattice" src="../../images/getting_started/prepare_layers/square_layer.svg" /></p>
<h4 id="kagome-lattice">Kagome Lattice</h4>
<p><img alt="Kagome structure" src="../../images/getting_started/prepare_layers/kagomegen.svg" /></p>
<p>Now let us look at a more complex lattice — the kagome lattice. This structure has three lattice points (A, B, and C, marked with red, blue, and green in the above image) in each unit cell. Each of them has four neighbours — two within the same cell and two in diagonally opposite positions to the first two.</p>
<pre class="highlight"><code class="language-python">class KagomeLayer(Layer):
    def __init__(self, pbc=False, study_proximity: int=1) -&gt; None:
        self.lv1 = np.array([1, 0])  # Lattice vector in the x-direction
        self.lv2 = np.array([0.5, np.sqrt(3)/2])  # Lattice vector at 60 degrees

        self.lattice_points = (
            [0, 0, "A"],
            [0.5, 0, "B"],
            [0.25, np.sqrt(3)/4, "C"],
        )

        self.neighbours = {
            "A": [
                [ 0.5,              0],  # Right
                [ 0.25,  np.sqrt(3)/4],  # Right-up
                [-0.5,              0],  # Left
                [-0.25, -np.sqrt(3)/4],  # Left-down
            ],
            "B": [
                [ 0.5,              0],  # Right
                [-0.25,  np.sqrt(3)/4],  # Left-up
                [-0.5,              0],  # Left
                [ 0.25, -np.sqrt(3)/4],  # Right-down
            ],
            "C": [
                [ 0.25,  np.sqrt(3)/4],  # Right-up
                [-0.25,  np.sqrt(3)/4],  # Left-up
                [-0.25, -np.sqrt(3)/4],  # Left-down
                [ 0.25, -np.sqrt(3)/4],  # Right-down
            ],
        }
        super().__init__(pbc=pbc, study_proximity=study_proximity)</code></pre>
<p>Now let us plot this lattice as well.</p>
<pre class="highlight"><code class="language-python">&gt;&gt;&gt; kagome_layer = KagomeLayer(pbc=True, study_proximity=1)
&gt;&gt;&gt; kagome_layer.generate_points(
&gt;&gt;&gt;     np.array([7, 0]),
&gt;&gt;&gt;     np.array([0, 5]),
&gt;&gt;&gt;     1, 1, test=True,
&gt;&gt;&gt; )
&gt;&gt;&gt; kagome_layer.plot_lattice()</code></pre>
<p><img alt="Kagome Lattice" src="../../images/getting_started/prepare_layers/kagome_layer.svg" /></p>
<h2 id="inbuilt-layers">Inbuilt Layers</h2>
<p>Although we highly recommend defining your own layers for research purposes, MoirePy provides a few basic lattices for quick testing and prototyping. These are available in the <code>moirepy.layers</code> module. Here’s a list of the available layers:</p>
<ul>
<li><code>moirepy.SquareLayer</code>: A simple square lattice as shown above.</li>
<li><code>moirepy.TriangularLayer</code>: A triangular lattice with <span class="arithmatex">\(60^\circ\)</span> angles.</li>
<li><code>moirepy.HexagonalLayer</code>: A hexagonal lattice with <span class="arithmatex">\(60^\circ\)</span> angles and two points per unit cell.</li>
<li><code>moirepy.KagomeLayer</code>: A kagome lattice as shown above.</li>
</ul>
<p>Here are the blueprints of these lattices:</p>
<div style="display: flex; justify-content: center; gap: 20px; align-items: flex-start; flex-wrap: wrap;">

  <figure style="margin: 0; text-align: center;">
    <img src="../../images/getting_started/prepare_layers/squaregen.svg" alt="Concentric Lattice Points" style="max-width: 100%; width: 300px;">
    <figcaption style="margin-top: 8px; font-style: italic;">Square Lattice</figcaption>
  </figure>

  <figure style="margin: 0; text-align: center;">
    <img src="../../images/getting_started/prepare_layers/trianglegen.svg" alt="Number of Points per Radius Level" style="max-width: 100%; width: 300px;">
    <figcaption style="margin-top: 8px; font-style: italic;">Triangle Lattice</figcaption>
  </figure>

  <figure style="margin: 0; text-align: center;">
    <img src="../../images/getting_started/prepare_layers/hexagongen.svg" alt="Number of Points per Radius Level" style="max-width: 100%; width: 300px;">
    <figcaption style="margin-top: 8px; font-style: italic;">Hexagon Lattice</figcaption>
  </figure>

  <figure style="margin: 0; text-align: center;">
    <img src="../../images/getting_started/prepare_layers/kagomegen.svg" alt="Number of Points per Radius Level" style="max-width: 100%; width: 300px;">
    <figcaption style="margin-top: 8px; font-style: italic;">Kagome Lattice</figcaption>
  </figure>

</div>

<p>Now that you've seen how to define custom layers — and also explored the inbuilt ones — you should have a good understanding of how individual lattices are represented in MoirePy.</p>
<p>We encourage you to experiment with creating your own layer classes suited to your specific research needs. The inbuilt layers are helpful for quick prototyping, but the real power of MoirePy lies in its flexibility.</p>
<hr />
<p>In this section we learned how to <strong>define custom layers</strong> using the <code>Layer</code> class. We also noted the inbuilt layers available in MoirePy for quick testing.</p>
<p>In the next section, we’ll explore how to <strong>combine two layers into a moiré superlattice</strong>, and how to use these structures to <strong>build the tight-binding Hamiltonians</strong> and compute physical observables.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../installation/" class="btn btn-neutral float-left" title="Installation"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../moire_lattice_and_hamiltonian/" class="btn btn-neutral float-right" title="Moiré Lattice and Hamiltonian">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/jabed-umar/MoirePy" class="fa fa-code-fork" style="color: #fcfcfc"> jabed-umar/MoirePy</a>
        </span>
    
    
      <span><a href="../installation/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../moire_lattice_and_hamiltonian/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
